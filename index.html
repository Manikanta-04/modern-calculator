<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculator</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;700&family=JetBrains+Mono:wght@500&display=swap" rel="stylesheet">
    <style>
        :root {
            --color-bg: #fafaf9;
            --color-surface: #ffffff;
            --color-primary: #18181b;
            --color-secondary: #52525b;
            --color-border: #e7e5e4;
            --color-error: #dc2626;
            --shadow-sm: 0 1px 2px rgba(0, 0, 0, 0.04);
            --shadow-md: 0 4px 12px rgba(0, 0, 0, 0.06);
            --shadow-lg: 0 8px 24px rgba(0, 0, 0, 0.08);
            --spacing-xs: 0.5rem;
            --spacing-sm: 0.75rem;
            --spacing-md: 1rem;
            --spacing-lg: 1.5rem;
            --radius-sm: 8px;
            --radius-md: 12px;
            --radius-lg: 16px;
            --font-body: 'DM Sans', -apple-system, BlinkMacSystemFont, sans-serif;
            --font-mono: 'JetBrains Mono', 'SF Mono', Consolas, monospace;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: var(--font-body);
            background: var(--color-bg);
            color: var(--color-primary);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: var(--spacing-lg);
            -webkit-font-smoothing: antialiased;
        }
        
        .calculator {
            width: 100%;
            max-width: 360px;
            background: var(--color-surface);
            border-radius: var(--radius-lg);
            padding: var(--spacing-lg);
            box-shadow: var(--shadow-lg);
            border: 1px solid var(--color-border);
            animation: slideIn 0.4s cubic-bezier(0.16, 1, 0.3, 1);
        }
        
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(20px) scale(0.96);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }
        
        .display {
            background: linear-gradient(135deg, #fafaf9 0%, #f5f5f4 100%);
            border: 1px solid var(--color-border);
            border-radius: var(--radius-md);
            padding: var(--spacing-lg) var(--spacing-md);
            margin-bottom: var(--spacing-lg);
            min-height: 100px;
            display: flex;
            flex-direction: column;
            align-items: flex-end;
            justify-content: flex-end;
        }
        
        .display-previous {
            font-family: var(--font-mono);
            font-size: 0.875rem;
            color: var(--color-secondary);
            margin-bottom: var(--spacing-xs);
            min-height: 20px;
            text-align: right;
            width: 100%;
        }
        
        .display-current {
            font-family: var(--font-mono);
            font-size: 2.5rem;
            font-weight: 500;
            color: var(--color-primary);
            text-align: right;
            width: 100%;
            letter-spacing: -0.02em;
        }
        
        .display.error .display-current {
            color: var(--color-error);
            font-size: 1.25rem;
        }
        
        .buttons {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: var(--spacing-sm);
        }
        
        button {
            font-family: var(--font-body);
            font-size: 1.125rem;
            font-weight: 500;
            padding: var(--spacing-lg);
            border: 1px solid var(--color-border);
            border-radius: var(--radius-sm);
            background: var(--color-surface);
            color: var(--color-primary);
            cursor: pointer;
            transition: all 0.15s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: var(--shadow-sm);
            position: relative;
            overflow: hidden;
        }
        
        button:active {
            transform: scale(0.96);
        }
        
        button:hover {
            background: #f9f9f9;
            border-color: #d6d3d1;
            box-shadow: var(--shadow-md);
        }
        
        .operator {
            background: linear-gradient(135deg, #27272a 0%, #18181b 100%);
            color: #ffffff;
            border-color: #27272a;
            font-weight: 600;
        }
        
        .operator:hover {
            background: linear-gradient(135deg, #3f3f46 0%, #27272a 100%);
        }
        
        .clear {
            background: var(--color-error);
            color: #ffffff;
            border-color: var(--color-error);
            font-weight: 600;
        }
        
        .clear:hover {
            background: #b91c1c;
        }
        
        .delete {
            background: var(--color-secondary);
            color: #ffffff;
            border-color: var(--color-secondary);
            font-size: 1.25rem;
        }
        
        .delete:hover {
            background: #3f3f46;
        }
        
        .equals {
            grid-column: span 2;
            background: linear-gradient(135deg, #27272a 0%, #18181b 100%);
            color: #ffffff;
            border-color: #27272a;
            font-weight: 700;
            font-size: 1.25rem;
        }
        
        .equals:hover {
            background: linear-gradient(135deg, #3f3f46 0%, #27272a 100%);
        }
        
        @media (max-width: 380px) {
            .calculator {
                padding: var(--spacing-md);
            }
            .display-current {
                font-size: 2rem;
            }
            button {
                padding: var(--spacing-md);
                font-size: 1rem;
            }
        }
    </style>
</head>
<body>
    <div class="calculator">
        <div class="display" id="display">
            <div class="display-previous" id="previousDisplay"></div>
            <div class="display-current" id="currentDisplay">0</div>
        </div>
        
        <div class="buttons">
            <button class="clear" onclick="clearCalculator()">C</button>
            <button class="delete" onclick="deleteDigit()">⌫</button>
            <button class="operator" onclick="appendOperator('/')">/</button>
            <button class="operator" onclick="appendOperator('*')">×</button>
            
            <button onclick="appendNumber('7')">7</button>
            <button onclick="appendNumber('8')">8</button>
            <button onclick="appendNumber('9')">9</button>
            <button class="operator" onclick="appendOperator('-')">−</button>
            
            <button onclick="appendNumber('4')">4</button>
            <button onclick="appendNumber('5')">5</button>
            <button onclick="appendNumber('6')">6</button>
            <button class="operator" onclick="appendOperator('+')">+</button>
            
            <button onclick="appendNumber('1')">1</button>
            <button onclick="appendNumber('2')">2</button>
            <button onclick="appendNumber('3')">3</button>
            <button onclick="appendDecimal()">.</button>
            
            <button onclick="appendNumber('0')">0</button>
            <button class="equals" onclick="calculate()">=</button>
        </div>
    </div>

    <script>
        let currentValue = '0';
        let previousValue = '';
        let operator = null;
        let shouldResetScreen = false;
        
        const currentDisplay = document.getElementById('currentDisplay');
        const previousDisplay = document.getElementById('previousDisplay');
        const displayElement = document.getElementById('display');
        
        function updateDisplay() {
            currentDisplay.textContent = currentValue;
            if (previousValue && operator) {
                previousDisplay.textContent = `${previousValue} ${getOperatorSymbol(operator)}`;
            } else {
                previousDisplay.textContent = '';
            }
        }
        
        function getOperatorSymbol(op) {
            const symbols = {'+': '+', '-': '−', '*': '×', '/': '/'};
            return symbols[op] || op;
        }
        
        function showError(message) {
            displayElement.classList.add('error');
            currentDisplay.textContent = message;
            previousDisplay.textContent = '';
            setTimeout(() => {
                displayElement.classList.remove('error');
                clearCalculator();
            }, 2000);
        }
        
        function appendNumber(number) {
            if (shouldResetScreen) {
                currentValue = number;
                shouldResetScreen = false;
            } else {
                if (currentValue === '0') {
                    currentValue = number;
                } else if (currentValue.length < 12) {
                    currentValue += number;
                }
            }
            updateDisplay();
        }
        
        function appendDecimal() {
            if (shouldResetScreen) {
                currentValue = '0';
                shouldResetScreen = false;
            }
            if (!currentValue.includes('.')) {
                currentValue += '.';
            }
            updateDisplay();
        }
        
        function appendOperator(op) {
            if (operator !== null && !shouldResetScreen) {
                calculate();
            }
            previousValue = currentValue;
            operator = op;
            shouldResetScreen = true;
            updateDisplay();
        }
        
        function calculate() {
            if (operator === null || previousValue === '') return;
            
            const prev = parseFloat(previousValue);
            const current = parseFloat(currentValue);
            
            if (isNaN(prev) || isNaN(current)) {
                showError('Invalid input');
                return;
            }
            
            let result;
            switch (operator) {
                case '+': result = prev + current; break;
                case '-': result = prev - current; break;
                case '*': result = prev * current; break;
                case '/':
                    if (current === 0) {
                        showError('Cannot divide by zero');
                        return;
                    }
                    result = prev / current;
                    break;
                default: return;
            }
            
            result = Math.round(result * 10000000000) / 10000000000;
            currentValue = result.toString();
            if (currentValue.length > 12) {
                currentValue = result.toExponential(6);
            }
            
            operator = null;
            previousValue = '';
            shouldResetScreen = true;
            updateDisplay();
        }
        
        function clearCalculator() {
            currentValue = '0';
            previousValue = '';
            operator = null;
            shouldResetScreen = false;
            displayElement.classList.remove('error');
            updateDisplay();
        }
        
        function deleteDigit() {
            if (displayElement.classList.contains('error') || shouldResetScreen) return;
            currentValue = currentValue.length > 1 ? currentValue.slice(0, -1) : '0';
            updateDisplay();
        }
        
        document.addEventListener('keydown', (event) => {
            const key = event.key;
            if (key >= '0' && key <= '9') appendNumber(key);
            else if (key === '.') appendDecimal();
            else if (key === '+' || key === '-' || key === '*' || key === '/') appendOperator(key);
            else if (key === 'Enter' || key === '=') { event.preventDefault(); calculate(); }
            else if (key === 'Backspace') { event.preventDefault(); deleteDigit(); }
            else if (key === 'Escape' || key === 'Delete') clearCalculator();
        });
        
        updateDisplay();
    </script>
</body>
</html>